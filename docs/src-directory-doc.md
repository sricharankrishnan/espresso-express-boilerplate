# SRC Directory
<br/>
The src directory is the very heart of the Espresso Application and is the place you can expect to spend a majority of your time when you are building your web application using Espresso. When you enter the directory, you can expect to see various sub directories, each with their own purpose and their pre built files and contents. Whether its building a new route and its handlers, initializing a new middleware or creating a new loader, the src directory serves that purpose. As the project evolves and moves along the timeline, the structure of the directory may change (I might either remove or add).<br/><br/>

The reason why I wanted to keep most of the application files in the src directory was because the initial scaffold (after you've downloaded from github), needed to <strong>be more aesthetically appealing and easier to handle</strong>. Seeing too many directories and files in the initial scaffold can sometimes daunting and overwhelming for some, but with a designated space, it should be much better.
<br/><br/>

## Whats Inside
<strong>Loaders</strong> - lets start with the loaders directory. Applications require some level of initial configuration and start up to help them perform various tasks. This is where the loaders directory comes in. It contains various files that help contribute to the start up of the application. Many NPM packages that are downloaded and built into this system, will often require some level of configuration. What you can expect to take away from this directory is that if you have a new package from NPM that you wish to install that requires an initial configuration or perhaps you are building something that is unique to your project that needs to have some form of initialization, this is the ideal directory.

Files placed in this directory should follow the pattern <u>${filename}.loader.js</u> and here are the files that we have in the directory pre built for you:

+ <b><em>index.loader.js:</em></b> - is connected to all the loader files in the directory. This is imported into the main server.js file and is executed, which in turn executes the other loaders in the application. So if you have a new loader file that you wish to add, start from here and require it as per the file path
+ <b><em>app.loader.js:</em></b> - various configurations for the application in terms of the directory for static assets etc.
+ <b><em>app-templating-engine.loader.js:</em></b> - the file that initializes the templating engine. Espresso uses EJS but feel free to make changes to which ever templating engine that you're comfortable with. Please note that the application comes with certain Demo HTML files, if things break when you change the templating engine, it probably means that you need to fix the UI as well or build one yourself
+ <b><em>body-parser.loader.js:</em></b> - refers to the loader file for [NPM Body Parser](https://www.npmjs.com/package/body-parser). Refer to the body parser documentation for more info incase you wish to understand how this works.
+ <b><em>compression.loader.js:</em></b> - a loader file from [NPM Compression](https://www.npmjs.com/package/compression). There are sufficient example available on the internet that discuss the advantages of having some form of compression. Very helpful for websites. I have (just the example in the docs) added a condition that if we have a request header <em>'x-no-compression'</em> with the value of false, then that particular request will skip the compression process.
+ <b><em>cookie-parser.loader.js</em></b> - the [NPM Cookie Parser](https://www.npmjs.com/package/cookie-parser) package is initialized in this file. The cookie parser is responsible for collecting and placing cookie data as either regular cookies (which can be accessed @ req.cookies) or special signed cookies (these are accessed @ req.signedCookies). The cookie parser apart from other functionalities can take a string value which can be used as the <em>Secret</em> for signed cookies. [Refer Express JS Docs](https://expressjs.com/en/4x/api.html#res.cookie).
+ <b><em>helmet.loader.js:</em></b> -you may not be an expert in web security but everyone in my opinion deserves to have some support when it comes to having a safe and secure application. [NPM Helmet](https://www.npmjs.com/package/helmet) is a javascript based security package that is quite suitable for Express JS applications and covers some of the basic yet critical portions of security. Based on my understanding, its a very popular pacakge that should ideally be in all Express JS applications until something better comes by.
+ <b><em>ignore-default-favicon.loader.js:</em></b> - although this is not an NPM Package, this is being placed to help prevent that pesky favicon route not found error in your express application. Try disabling this and see what I mean.
+ <b><em>morgan-request-logger.loader.js:</em></b> - [NPM Morgan](https://www.npmjs.com/package/morgan) is an HTTP request logger middleware for node.js that you can use in your application to see how requests are coming in and their respective status. In this application, morgan outputs are not only being placed on the console for you to see but also, placed in the log files as a record of what requests have come in. If you wish to disable this, you can comment out Morgan in the index.loader.js file
+ <b><em>response-time.loader.js:</em></b> - [NPM Response Time](https://www.npmjs.com/package/response-time) is a package that serves as a middleware, that helps provide the response time for requests to HTTP servers. The package adds a <u>X-Response-Time</u> header to responses. A small but easy to integrate package, perhaps it would be useful in some way or the other.
+ <b><em>rfs.loader.js:</em></b> - this is defintely a brilliant package to have in your web server/application especially when it comes to controlling log files and writing information to them. Hands down. [NPM Rotating File Stream](https://www.npmjs.com/package/rotating-file-stream) is a package worth learning and you should know your way around this package if you need to make changes to log files that are suitable for your project requirements.
<br/><br/>

<strong>Middleware</strong> - the next directory that you ought to know about is the middleware directory. Following the principles of middleware in ExpressJS, any portion of your application that needs to be handled before reaching your routes (either in the beginning like authentation checks) needs to be placed in this directory. Files placed in this directory should ideally be named in the patter <b>```${filename}.middleware.js```</b>. How you wish to structure this directory beyond this point is completely upto you and your project requirements. The key take away is to understand the purpose of this directory and how you should name your files.
<br/><br/>

<strong>Models</strong> - this directory is the 'M' in MVC. As a sample I have provided two standardized response objects that you could use although you can come up with anything that is relevant and suitable. Files placed in the models directory should ideally be named in the pattern <b>```${filename}.model.js```</b>, also, this could also be the perfect place to store view objects for your front end HTML files. The model component in MVC mostly stores data and all its relevant logic. If you plan out your project well, things could shape up in a good way for you when using this directory.
<br/><br/>

<strong>Routes</strong> - yes, I believe its good to have a seperate directory for routes because we're planning to build and scale up for the future. It may be a slight overkill for smaller applications but placing this into practice can save you a lot of hassles when it comes to handling code. Every possible route that your application needs to have must fall into this directory and make that a standard. No ifs and buts! The entry point to this directory is the <b>```index.route.js```</b> file (and yes, files need to be name following a pattern <b>```${filename}.route.js```</b>). This entry file will receive the app object from server.js file which in turn imports other individual directories that represent the actual routes. Once you take a look at this directory, you'llknow what I mean.
<br/><br/>

<strong>Controllers</strong> - for every route that is existing, we need a handler and all of them per route will fall in to this directory. Each of these handler files will be imported (or required) and placed in the respective routes file in the routes directory. My opinion on what and how you should structure your application using this directory stops here. I have however, given a sample directory structure on what I think is good to handle a situtaion where you have a large application and many many routes with their respective handler callbacks. You be the boss and make your changes if you like to. I've also given suitable naming patterns for the files (example - a handler to be named as <b>```${filename}.handler.js```</b>)
<br/><br/>

<strong>Public</strong> - after you've downloaded the application and completed installation, goto http://localhost:4500/notes.txt and you will notice that the notes.txt file comes from the public folder. The purpose of this folder is providing something that should be publicly available (like some simple txt files and even sitemaps for seo requirements), place them here and you should be able to access them directly. The configuration for this directory is at ./src/loaders/app.loader.js file. Simple. To the point and we're done with this directory.
<br/><br/>

<strong>Static</strong> - good place to keep all your frontend static assets. Goto the ./src/loaders/app.loader.js file and you will see the paths that I have configured for these static files. There are currently 4 top level directories each with their own purpose - <b>views</b> is where all your html files go, <b>scripts</b> is where all your javascript files go, <b>css</b> is for your stylesheets and <b>assets</b> is for images, icons and videos. HTML files are built using [EJS Templating Engine](https://ejs.co/) and if you study the HTML file layouts, you'll get to understand how this all comes together. Again, the my opinion stops at the 4 Top level directories and you are more than welcome to make changes as per your project requirements beyond that. But yes, understanding this directory and how static assets like images and videos are referred in the html file will help you.
<br/><br/>

## Conclusion
Here are the key takeways from this directory for you:
+ Files in the src directory will follow a certain naming pattern. I've given examples of how they should be named, simply because it probably can make life easier in the long run, otherwise you could come up with your own naming conventions as well and adopt them safely
+ Structured approach to web development especially if you are managing a team of developers and you wish to have them following a pattern of building and doing things
+ You're trying to avoid nightmares when it comes to On boarding new talents and you don't have to scratch your head too much because of a certain structure and way of doing things
+ My opinion always stops at a certain point. Take charge of what needs to be done after that
+ This is the most important part of the application. Manage this well and you'll be okay.
